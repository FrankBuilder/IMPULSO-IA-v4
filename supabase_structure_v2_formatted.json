{
  "tables": {
    "corev4_chats": {
      "columns": [
        {
          "name": "id",
          "type": "bigint",
          "default": "nextval('corev4_chats_id_seq'::regclass)",
          "nullable": false,
          "position": 1,
          "udt_name": "int8",
          "max_length": null,
          "numeric_precision": 64
        },
        {
          "name": "company_id",
          "type": "integer",
          "default": null,
          "nullable": false,
          "position": 2,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "contact_id",
          "type": "bigint",
          "default": null,
          "nullable": false,
          "position": 3,
          "udt_name": "int8",
          "max_length": null,
          "numeric_precision": 64
        },
        {
          "name": "agent_alias",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 4,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "last_message_ts",
          "type": "bigint",
          "default": null,
          "nullable": true,
          "position": 5,
          "udt_name": "int8",
          "max_length": null,
          "numeric_precision": 64
        },
        {
          "name": "last_lead_message_ts",
          "type": "bigint",
          "default": null,
          "nullable": true,
          "position": 6,
          "udt_name": "int8",
          "max_length": null,
          "numeric_precision": 64
        },
        {
          "name": "last_agent_message_ts",
          "type": "bigint",
          "default": null,
          "nullable": true,
          "position": 7,
          "udt_name": "int8",
          "max_length": null,
          "numeric_precision": 64
        },
        {
          "name": "batch_collecting",
          "type": "boolean",
          "default": "false",
          "nullable": true,
          "position": 8,
          "udt_name": "bool",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "batch_expires_at",
          "type": "timestamp with time zone",
          "default": null,
          "nullable": true,
          "position": 9,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "conversation_open",
          "type": "boolean",
          "default": "true",
          "nullable": true,
          "position": 10,
          "udt_name": "bool",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "closed_reason",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 11,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "default": "now()",
          "nullable": true,
          "position": 12,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "default": "now()",
          "nullable": true,
          "position": 13,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        }
      ],
      "indexes": [
        {
          "name": "corev4_chats_pkey",
          "is_unique": true,
          "definition": "CREATE UNIQUE INDEX corev4_chats_pkey ON public.corev4_chats USING btree (id)",
          "is_primary": true
        },
        {
          "name": "unique_contact_chat",
          "is_unique": true,
          "definition": "CREATE UNIQUE INDEX unique_contact_chat ON public.corev4_chats USING btree (contact_id, company_id)",
          "is_primary": false
        },
        {
          "name": "idx_chats_contact",
          "is_unique": false,
          "definition": "CREATE INDEX idx_chats_contact ON public.corev4_chats USING btree (contact_id)",
          "is_primary": false
        },
        {
          "name": "idx_chats_company",
          "is_unique": false,
          "definition": "CREATE INDEX idx_chats_company ON public.corev4_chats USING btree (company_id)",
          "is_primary": false
        },
        {
          "name": "idx_chats_open",
          "is_unique": false,
          "definition": "CREATE INDEX idx_chats_open ON public.corev4_chats USING btree (conversation_open) WHERE (conversation_open = true)",
          "is_primary": false
        },
        {
          "name": "idx_chats_batch",
          "is_unique": false,
          "definition": "CREATE INDEX idx_chats_batch ON public.corev4_chats USING btree (batch_collecting) WHERE (batch_collecting = true)",
          "is_primary": false
        },
        {
          "name": "idx_chats_last_message",
          "is_unique": false,
          "definition": "CREATE INDEX idx_chats_last_message ON public.corev4_chats USING btree (last_message_ts DESC NULLS LAST)",
          "is_primary": false
        },
        {
          "name": "idx_chats_conversation_open",
          "is_unique": false,
          "definition": "CREATE INDEX idx_chats_conversation_open ON public.corev4_chats USING btree (conversation_open) WHERE (conversation_open = true)",
          "is_primary": false
        }
      ],
      "foreign_keys": [
        {
          "column": "contact_id",
          "on_delete": "CASCADE",
          "on_update": "NO ACTION",
          "constraint_name": "corev4_chats_contact_id_fkey",
          "references_table": "corev4_contacts",
          "references_column": "id"
        }
      ],
      "primary_keys": [
        "id"
      ],
      "unique_constraints": [
        {
          "columns": [
            "contact_id",
            "company_id"
          ],
          "constraint_name": "unique_contact_chat"
        }
      ]
    },
    "corev4_contacts": {
      "columns": [
        {
          "name": "id",
          "type": "bigint",
          "default": "nextval('corev4_contacts_id_seq'::regclass)",
          "nullable": false,
          "position": 1,
          "udt_name": "int8",
          "max_length": null,
          "numeric_precision": 64
        },
        {
          "name": "company_id",
          "type": "integer",
          "default": null,
          "nullable": false,
          "position": 2,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "full_name",
          "type": "text",
          "default": null,
          "nullable": false,
          "position": 3,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "whatsapp",
          "type": "text",
          "default": null,
          "nullable": false,
          "position": 4,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "phone_number",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 5,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "email",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 6,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "origin_source",
          "type": "text",
          "default": "'whatsapp'::text",
          "nullable": false,
          "position": 7,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "utm_source",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 8,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "utm_medium",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 9,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "utm_campaign",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 10,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "utm_adgroup",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 11,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "utm_creative",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 12,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "sector",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 13,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "tags",
          "type": "ARRAY",
          "default": "'{}'::text[]",
          "nullable": true,
          "position": 14,
          "udt_name": "_text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "opt_out",
          "type": "boolean",
          "default": "false",
          "nullable": true,
          "position": 15,
          "udt_name": "bool",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "is_active",
          "type": "boolean",
          "default": "true",
          "nullable": true,
          "position": 16,
          "udt_name": "bool",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "default": "now()",
          "nullable": true,
          "position": 17,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "default": "now()",
          "nullable": true,
          "position": 18,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "last_interaction_at",
          "type": "timestamp with time zone",
          "default": null,
          "nullable": true,
          "position": 19,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        }
      ],
      "indexes": [
        {
          "name": "corev4_contacts_pkey",
          "is_unique": true,
          "definition": "CREATE UNIQUE INDEX corev4_contacts_pkey ON public.corev4_contacts USING btree (id)",
          "is_primary": true
        },
        {
          "name": "unique_whatsapp_company",
          "is_unique": true,
          "definition": "CREATE UNIQUE INDEX unique_whatsapp_company ON public.corev4_contacts USING btree (whatsapp, company_id)",
          "is_primary": false
        },
        {
          "name": "idx_contacts_company",
          "is_unique": false,
          "definition": "CREATE INDEX idx_contacts_company ON public.corev4_contacts USING btree (company_id)",
          "is_primary": false
        },
        {
          "name": "idx_contacts_whatsapp",
          "is_unique": false,
          "definition": "CREATE INDEX idx_contacts_whatsapp ON public.corev4_contacts USING btree (whatsapp)",
          "is_primary": false
        },
        {
          "name": "idx_contacts_email",
          "is_unique": false,
          "definition": "CREATE INDEX idx_contacts_email ON public.corev4_contacts USING btree (email) WHERE (email IS NOT NULL)",
          "is_primary": false
        },
        {
          "name": "idx_contacts_active",
          "is_unique": false,
          "definition": "CREATE INDEX idx_contacts_active ON public.corev4_contacts USING btree (is_active) WHERE (is_active = true)",
          "is_primary": false
        },
        {
          "name": "idx_contacts_opt_out",
          "is_unique": false,
          "definition": "CREATE INDEX idx_contacts_opt_out ON public.corev4_contacts USING btree (opt_out) WHERE (opt_out = false)",
          "is_primary": false
        },
        {
          "name": "idx_contacts_last_interaction",
          "is_unique": false,
          "definition": "CREATE INDEX idx_contacts_last_interaction ON public.corev4_contacts USING btree (last_interaction_at DESC NULLS LAST)",
          "is_primary": false
        },
        {
          "name": "idx_contacts_full_name_trgm",
          "is_unique": false,
          "definition": "CREATE INDEX idx_contacts_full_name_trgm ON public.corev4_contacts USING gin (full_name gin_trgm_ops)",
          "is_primary": false
        },
        {
          "name": "idx_contacts_created",
          "is_unique": false,
          "definition": "CREATE INDEX idx_contacts_created ON public.corev4_contacts USING btree (created_at DESC)",
          "is_primary": false
        }
      ],
      "foreign_keys": [],
      "primary_keys": [
        "id"
      ],
      "unique_constraints": [
        {
          "columns": [
            "whatsapp",
            "company_id"
          ],
          "constraint_name": "unique_whatsapp_company"
        }
      ]
    },
    "corev4_companies": {
      "columns": [
        {
          "name": "id",
          "type": "integer",
          "default": "nextval('corev4_companies_id_seq'::regclass)",
          "nullable": false,
          "position": 1,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "name",
          "type": "character varying",
          "default": null,
          "nullable": false,
          "position": 2,
          "udt_name": "varchar",
          "max_length": 255,
          "numeric_precision": null
        },
        {
          "name": "slug",
          "type": "character varying",
          "default": null,
          "nullable": false,
          "position": 3,
          "udt_name": "varchar",
          "max_length": 255,
          "numeric_precision": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "default": "now()",
          "nullable": true,
          "position": 4,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "default": "now()",
          "nullable": true,
          "position": 5,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "evolution_api_url",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 6,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "evolution_instance",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 7,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "evolution_api_key",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 8,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "enable_anum_analysis",
          "type": "boolean",
          "default": "true",
          "nullable": true,
          "position": 9,
          "udt_name": "bool",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "anum_threshold_qualified",
          "type": "integer",
          "default": "70",
          "nullable": true,
          "position": 10,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "anum_threshold_disqualified",
          "type": "integer",
          "default": "20",
          "nullable": true,
          "position": 11,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "enable_followup_campaigns",
          "type": "boolean",
          "default": "true",
          "nullable": true,
          "position": 12,
          "udt_name": "bool",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "auto_create_campaigns",
          "type": "boolean",
          "default": "false",
          "nullable": true,
          "position": 13,
          "udt_name": "bool",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "default_followup_config_id",
          "type": "integer",
          "default": null,
          "nullable": true,
          "position": 14,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "contact_type_mode",
          "type": "character varying",
          "default": "'leads_only'::character varying",
          "nullable": true,
          "position": 15,
          "udt_name": "varchar",
          "max_length": 50,
          "numeric_precision": null
        },
        {
          "name": "enable_audio_responses",
          "type": "boolean",
          "default": "false",
          "nullable": true,
          "position": 16,
          "udt_name": "bool",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "enable_media_processing",
          "type": "boolean",
          "default": "true",
          "nullable": true,
          "position": 17,
          "udt_name": "bool",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "enable_command_processing",
          "type": "boolean",
          "default": "true",
          "nullable": true,
          "position": 18,
          "udt_name": "bool",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "llm_model",
          "type": "character varying",
          "default": "'gpt-4-turbo'::character varying",
          "nullable": true,
          "position": 19,
          "udt_name": "varchar",
          "max_length": 100,
          "numeric_precision": null
        },
        {
          "name": "llm_temperature",
          "type": "numeric",
          "default": "0.7",
          "nullable": true,
          "position": 20,
          "udt_name": "numeric",
          "max_length": null,
          "numeric_precision": 3
        },
        {
          "name": "llm_max_tokens",
          "type": "integer",
          "default": "1000",
          "nullable": true,
          "position": 21,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "bot_name",
          "type": "character varying",
          "default": "'Frank'::character varying",
          "nullable": true,
          "position": 22,
          "udt_name": "varchar",
          "max_length": 100,
          "numeric_precision": null
        },
        {
          "name": "bot_personality",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 23,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "system_prompt",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 24,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "greeting_message",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 25,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "webhook_secret",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 26,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "webhook_validation_enabled",
          "type": "boolean",
          "default": "false",
          "nullable": true,
          "position": 27,
          "udt_name": "bool",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "crm_integration",
          "type": "character varying",
          "default": null,
          "nullable": true,
          "position": 28,
          "udt_name": "varchar",
          "max_length": 50,
          "numeric_precision": null
        },
        {
          "name": "crm_api_key",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 29,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "crm_pipeline_id",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 30,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "features",
          "type": "jsonb",
          "default": "'{}'::jsonb",
          "nullable": true,
          "position": 31,
          "udt_name": "jsonb",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "plan_tier",
          "type": "character varying",
          "default": "'free'::character varying",
          "nullable": true,
          "position": 32,
          "udt_name": "varchar",
          "max_length": 50,
          "numeric_precision": null
        },
        {
          "name": "monthly_message_limit",
          "type": "integer",
          "default": "1000",
          "nullable": true,
          "position": 33,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "current_month_messages",
          "type": "integer",
          "default": "0",
          "nullable": true,
          "position": 34,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "billing_email",
          "type": "character varying",
          "default": null,
          "nullable": true,
          "position": 35,
          "udt_name": "varchar",
          "max_length": 255,
          "numeric_precision": null
        },
        {
          "name": "is_active",
          "type": "boolean",
          "default": "true",
          "nullable": true,
          "position": 36,
          "udt_name": "bool",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "suspended_reason",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 37,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "trial_ends_at",
          "type": "timestamp with time zone",
          "default": null,
          "nullable": true,
          "position": 38,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        }
      ],
      "indexes": [
        {
          "name": "idx_companies_slug",
          "is_unique": false,
          "definition": "CREATE INDEX idx_companies_slug ON public.corev4_companies USING btree (slug)",
          "is_primary": false
        },
        {
          "name": "idx_companies_is_active",
          "is_unique": false,
          "definition": "CREATE INDEX idx_companies_is_active ON public.corev4_companies USING btree (is_active)",
          "is_primary": false
        },
        {
          "name": "idx_companies_plan_tier",
          "is_unique": false,
          "definition": "CREATE INDEX idx_companies_plan_tier ON public.corev4_companies USING btree (plan_tier)",
          "is_primary": false
        },
        {
          "name": "corev4_companies_pkey",
          "is_unique": true,
          "definition": "CREATE UNIQUE INDEX corev4_companies_pkey ON public.corev4_companies USING btree (id)",
          "is_primary": true
        },
        {
          "name": "corev4_companies_slug_key",
          "is_unique": true,
          "definition": "CREATE UNIQUE INDEX corev4_companies_slug_key ON public.corev4_companies USING btree (slug)",
          "is_primary": false
        }
      ],
      "foreign_keys": [
        {
          "column": "default_followup_config_id",
          "on_delete": "NO ACTION",
          "on_update": "NO ACTION",
          "constraint_name": "corev4_companies_default_followup_config_id_fkey",
          "references_table": "corev4_followup_configs",
          "references_column": "id"
        }
      ],
      "primary_keys": [
        "id"
      ],
      "unique_constraints": [
        {
          "columns": [
            "slug"
          ],
          "constraint_name": "corev4_companies_slug_key"
        }
      ]
    },
    "corev4_lead_state": {
      "columns": [
        {
          "name": "id",
          "type": "integer",
          "default": "nextval('corev4_lead_state_id_seq'::regclass)",
          "nullable": false,
          "position": 1,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "company_id",
          "type": "integer",
          "default": null,
          "nullable": false,
          "position": 2,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "contact_id",
          "type": "integer",
          "default": null,
          "nullable": false,
          "position": 3,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "authority_score",
          "type": "integer",
          "default": null,
          "nullable": true,
          "position": 4,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "need_score",
          "type": "integer",
          "default": null,
          "nullable": true,
          "position": 5,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "urgency_score",
          "type": "integer",
          "default": null,
          "nullable": true,
          "position": 6,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "money_score",
          "type": "integer",
          "default": null,
          "nullable": true,
          "position": 7,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "total_score",
          "type": "numeric",
          "default": null,
          "nullable": true,
          "position": 8,
          "udt_name": "numeric",
          "max_length": null,
          "numeric_precision": 5
        },
        {
          "name": "qualification_stage",
          "type": "character varying",
          "default": null,
          "nullable": true,
          "position": 9,
          "udt_name": "varchar",
          "max_length": 20,
          "numeric_precision": null
        },
        {
          "name": "profile",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 10,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "main_pain",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 11,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "main_objection",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 12,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "prob_conversion",
          "type": "numeric",
          "default": null,
          "nullable": true,
          "position": 13,
          "udt_name": "numeric",
          "max_length": null,
          "numeric_precision": 5
        },
        {
          "name": "next_objective",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 14,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "suggested_question",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 15,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "status",
          "type": "character varying",
          "default": "'cold'::character varying",
          "nullable": true,
          "position": 16,
          "udt_name": "varchar",
          "max_length": 50,
          "numeric_precision": null
        },
        {
          "name": "last_analyzed_at",
          "type": "timestamp with time zone",
          "default": null,
          "nullable": true,
          "position": 17,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "analysis_count",
          "type": "integer",
          "default": "0",
          "nullable": true,
          "position": 18,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "is_qualified",
          "type": "boolean",
          "default": "false",
          "nullable": true,
          "position": 19,
          "udt_name": "bool",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "default": "now()",
          "nullable": true,
          "position": 20,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "default": "now()",
          "nullable": true,
          "position": 21,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "analyzed_at",
          "type": "timestamp with time zone",
          "default": null,
          "nullable": true,
          "position": 22,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "last_analysis_id",
          "type": "integer",
          "default": null,
          "nullable": true,
          "position": 23,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        }
      ],
      "indexes": [
        {
          "name": "corev4_lead_state_pkey",
          "is_unique": true,
          "definition": "CREATE UNIQUE INDEX corev4_lead_state_pkey ON public.corev4_lead_state USING btree (id)",
          "is_primary": true
        },
        {
          "name": "corev4_lead_state_contact_id_key",
          "is_unique": true,
          "definition": "CREATE UNIQUE INDEX corev4_lead_state_contact_id_key ON public.corev4_lead_state USING btree (contact_id)",
          "is_primary": false
        },
        {
          "name": "idx_lead_state_contact",
          "is_unique": false,
          "definition": "CREATE INDEX idx_lead_state_contact ON public.corev4_lead_state USING btree (contact_id)",
          "is_primary": false
        },
        {
          "name": "idx_lead_state_company",
          "is_unique": false,
          "definition": "CREATE INDEX idx_lead_state_company ON public.corev4_lead_state USING btree (company_id)",
          "is_primary": false
        },
        {
          "name": "idx_lead_state_total_score",
          "is_unique": false,
          "definition": "CREATE INDEX idx_lead_state_total_score ON public.corev4_lead_state USING btree (total_score DESC)",
          "is_primary": false
        },
        {
          "name": "idx_lead_state_stage",
          "is_unique": false,
          "definition": "CREATE INDEX idx_lead_state_stage ON public.corev4_lead_state USING btree (qualification_stage)",
          "is_primary": false
        },
        {
          "name": "idx_lead_state_last_analyzed",
          "is_unique": false,
          "definition": "CREATE INDEX idx_lead_state_last_analyzed ON public.corev4_lead_state USING btree (last_analyzed_at)",
          "is_primary": false
        }
      ],
      "foreign_keys": [
        {
          "column": "company_id",
          "on_delete": "NO ACTION",
          "on_update": "NO ACTION",
          "constraint_name": "corev4_lead_state_company_id_fkey",
          "references_table": "corev4_companies",
          "references_column": "id"
        },
        {
          "column": "contact_id",
          "on_delete": "CASCADE",
          "on_update": "NO ACTION",
          "constraint_name": "corev4_lead_state_contact_id_fkey",
          "references_table": "corev4_contacts",
          "references_column": "id"
        }
      ],
      "primary_keys": [
        "id"
      ],
      "unique_constraints": [
        {
          "columns": [
            "contact_id"
          ],
          "constraint_name": "corev4_lead_state_contact_id_key"
        }
      ]
    },
    "corev4_ai_decisions": {
      "columns": [
        {
          "name": "id",
          "type": "integer",
          "default": "nextval('corev4_ai_decisions_id_seq'::regclass)",
          "nullable": false,
          "position": 1,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "followup_execution_id",
          "type": "integer",
          "default": null,
          "nullable": true,
          "position": 2,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "model_used",
          "type": "character varying",
          "default": null,
          "nullable": false,
          "position": 3,
          "udt_name": "varchar",
          "max_length": 50,
          "numeric_precision": null
        },
        {
          "name": "decision",
          "type": "character varying",
          "default": null,
          "nullable": false,
          "position": 4,
          "udt_name": "varchar",
          "max_length": 30,
          "numeric_precision": null
        },
        {
          "name": "confidence_score",
          "type": "integer",
          "default": null,
          "nullable": true,
          "position": 5,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "reasoning",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 6,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "context_snapshot",
          "type": "jsonb",
          "default": null,
          "nullable": true,
          "position": 7,
          "udt_name": "jsonb",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "processing_time_ms",
          "type": "integer",
          "default": null,
          "nullable": true,
          "position": 8,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "tokens_used",
          "type": "integer",
          "default": null,
          "nullable": true,
          "position": 9,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "cost_usd",
          "type": "numeric",
          "default": null,
          "nullable": true,
          "position": 10,
          "udt_name": "numeric",
          "max_length": null,
          "numeric_precision": 10
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "default": "now()",
          "nullable": true,
          "position": 11,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        }
      ],
      "indexes": [
        {
          "name": "corev4_ai_decisions_pkey",
          "is_unique": true,
          "definition": "CREATE UNIQUE INDEX corev4_ai_decisions_pkey ON public.corev4_ai_decisions USING btree (id)",
          "is_primary": true
        },
        {
          "name": "idx_ai_decisions_exec",
          "is_unique": false,
          "definition": "CREATE INDEX idx_ai_decisions_exec ON public.corev4_ai_decisions USING btree (followup_execution_id)",
          "is_primary": false
        },
        {
          "name": "idx_ai_decisions_model",
          "is_unique": false,
          "definition": "CREATE INDEX idx_ai_decisions_model ON public.corev4_ai_decisions USING btree (model_used)",
          "is_primary": false
        },
        {
          "name": "idx_ai_decisions_decision",
          "is_unique": false,
          "definition": "CREATE INDEX idx_ai_decisions_decision ON public.corev4_ai_decisions USING btree (decision)",
          "is_primary": false
        },
        {
          "name": "idx_ai_decisions_created",
          "is_unique": false,
          "definition": "CREATE INDEX idx_ai_decisions_created ON public.corev4_ai_decisions USING btree (created_at DESC)",
          "is_primary": false
        }
      ],
      "foreign_keys": [],
      "primary_keys": [
        "id"
      ],
      "unique_constraints": []
    },
    "corev4_anum_history": {
      "columns": [
        {
          "name": "id",
          "type": "integer",
          "default": "nextval('corev4_anum_history_id_seq'::regclass)",
          "nullable": false,
          "position": 1,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "contact_id",
          "type": "integer",
          "default": null,
          "nullable": false,
          "position": 2,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "company_id",
          "type": "integer",
          "default": null,
          "nullable": false,
          "position": 3,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "authority_score",
          "type": "integer",
          "default": null,
          "nullable": false,
          "position": 4,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "need_score",
          "type": "integer",
          "default": null,
          "nullable": false,
          "position": 5,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "urgency_score",
          "type": "integer",
          "default": null,
          "nullable": false,
          "position": 6,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "money_score",
          "type": "integer",
          "default": null,
          "nullable": false,
          "position": 7,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "total_score",
          "type": "numeric",
          "default": null,
          "nullable": false,
          "position": 8,
          "udt_name": "numeric",
          "max_length": null,
          "numeric_precision": 5
        },
        {
          "name": "is_qualified",
          "type": "boolean",
          "default": "false",
          "nullable": false,
          "position": 9,
          "udt_name": "bool",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "qualification_stage",
          "type": "character varying",
          "default": null,
          "nullable": true,
          "position": 10,
          "udt_name": "varchar",
          "max_length": 20,
          "numeric_precision": null
        },
        {
          "name": "evidence",
          "type": "jsonb",
          "default": null,
          "nullable": true,
          "position": 11,
          "udt_name": "jsonb",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "confidence_score",
          "type": "numeric",
          "default": null,
          "nullable": true,
          "position": 12,
          "udt_name": "numeric",
          "max_length": null,
          "numeric_precision": 3
        },
        {
          "name": "messages_analyzed",
          "type": "integer",
          "default": null,
          "nullable": false,
          "position": 13,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "analysis_reasoning",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 14,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "authority_delta",
          "type": "integer",
          "default": null,
          "nullable": true,
          "position": 15,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "need_delta",
          "type": "integer",
          "default": null,
          "nullable": true,
          "position": 16,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "urgency_delta",
          "type": "integer",
          "default": null,
          "nullable": true,
          "position": 17,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "money_delta",
          "type": "integer",
          "default": null,
          "nullable": true,
          "position": 18,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "trigger_source",
          "type": "character varying",
          "default": "'anum_analyzer'::character varying",
          "nullable": true,
          "position": 19,
          "udt_name": "varchar",
          "max_length": 50,
          "numeric_precision": null
        },
        {
          "name": "analyzed_at",
          "type": "timestamp with time zone",
          "default": "now()",
          "nullable": false,
          "position": 20,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "default": "now()",
          "nullable": false,
          "position": 21,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        }
      ],
      "indexes": [
        {
          "name": "corev4_anum_history_pkey",
          "is_unique": true,
          "definition": "CREATE UNIQUE INDEX corev4_anum_history_pkey ON public.corev4_anum_history USING btree (id)",
          "is_primary": true
        },
        {
          "name": "idx_anum_history_contact",
          "is_unique": false,
          "definition": "CREATE INDEX idx_anum_history_contact ON public.corev4_anum_history USING btree (contact_id)",
          "is_primary": false
        },
        {
          "name": "idx_anum_history_company",
          "is_unique": false,
          "definition": "CREATE INDEX idx_anum_history_company ON public.corev4_anum_history USING btree (company_id)",
          "is_primary": false
        },
        {
          "name": "idx_anum_history_analyzed_at",
          "is_unique": false,
          "definition": "CREATE INDEX idx_anum_history_analyzed_at ON public.corev4_anum_history USING btree (analyzed_at DESC)",
          "is_primary": false
        },
        {
          "name": "idx_anum_history_qualified",
          "is_unique": false,
          "definition": "CREATE INDEX idx_anum_history_qualified ON public.corev4_anum_history USING btree (is_qualified)",
          "is_primary": false
        }
      ],
      "foreign_keys": [
        {
          "column": "company_id",
          "on_delete": "CASCADE",
          "on_update": "NO ACTION",
          "constraint_name": "corev4_anum_history_company_id_fkey",
          "references_table": "corev4_companies",
          "references_column": "id"
        },
        {
          "column": "contact_id",
          "on_delete": "CASCADE",
          "on_update": "NO ACTION",
          "constraint_name": "corev4_anum_history_contact_id_fkey",
          "references_table": "corev4_contacts",
          "references_column": "id"
        }
      ],
      "primary_keys": [
        "id"
      ],
      "unique_constraints": []
    },
    "corev4_chat_history": {
      "columns": [
        {
          "name": "id",
          "type": "integer",
          "default": "nextval('corev4_chat_history_id_seq'::regclass)",
          "nullable": false,
          "position": 1,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "session_id",
          "type": "character varying",
          "default": null,
          "nullable": true,
          "position": 2,
          "udt_name": "varchar",
          "max_length": 255,
          "numeric_precision": null
        },
        {
          "name": "contact_id",
          "type": "integer",
          "default": null,
          "nullable": true,
          "position": 3,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "company_id",
          "type": "integer",
          "default": null,
          "nullable": true,
          "position": 4,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "role",
          "type": "character varying",
          "default": null,
          "nullable": true,
          "position": 5,
          "udt_name": "varchar",
          "max_length": 50,
          "numeric_precision": null
        },
        {
          "name": "message",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 6,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "message_type",
          "type": "character varying",
          "default": null,
          "nullable": true,
          "position": 7,
          "udt_name": "varchar",
          "max_length": 100,
          "numeric_precision": null
        },
        {
          "name": "media_url",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 8,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "media_mime_type",
          "type": "character varying",
          "default": null,
          "nullable": true,
          "position": 9,
          "udt_name": "varchar",
          "max_length": 100,
          "numeric_precision": null
        },
        {
          "name": "tokens_used",
          "type": "integer",
          "default": null,
          "nullable": true,
          "position": 10,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "cost_usd",
          "type": "numeric",
          "default": null,
          "nullable": true,
          "position": 11,
          "udt_name": "numeric",
          "max_length": null,
          "numeric_precision": 10
        },
        {
          "name": "model_used",
          "type": "character varying",
          "default": null,
          "nullable": true,
          "position": 12,
          "udt_name": "varchar",
          "max_length": 100,
          "numeric_precision": null
        },
        {
          "name": "message_timestamp",
          "type": "timestamp with time zone",
          "default": null,
          "nullable": true,
          "position": 13,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "default": "now()",
          "nullable": true,
          "position": 14,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "has_media",
          "type": "boolean",
          "default": "false",
          "nullable": true,
          "position": 15,
          "udt_name": "bool",
          "max_length": null,
          "numeric_precision": null
        }
      ],
      "indexes": [
        {
          "name": "corev4_chat_history_pkey",
          "is_unique": true,
          "definition": "CREATE UNIQUE INDEX corev4_chat_history_pkey ON public.corev4_chat_history USING btree (id)",
          "is_primary": true
        },
        {
          "name": "idx_chat_history_session",
          "is_unique": false,
          "definition": "CREATE INDEX idx_chat_history_session ON public.corev4_chat_history USING btree (session_id)",
          "is_primary": false
        },
        {
          "name": "idx_chat_history_contact",
          "is_unique": false,
          "definition": "CREATE INDEX idx_chat_history_contact ON public.corev4_chat_history USING btree (contact_id)",
          "is_primary": false
        },
        {
          "name": "idx_chat_history_has_media",
          "is_unique": false,
          "definition": "CREATE INDEX idx_chat_history_has_media ON public.corev4_chat_history USING btree (has_media) WHERE (has_media = true)",
          "is_primary": false
        }
      ],
      "foreign_keys": [],
      "primary_keys": [
        "id"
      ],
      "unique_constraints": []
    },
    "corev4_message_dedup": {
      "columns": [
        {
          "name": "message_id",
          "type": "text",
          "default": null,
          "nullable": false,
          "position": 1,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "whatsapp_id",
          "type": "text",
          "default": null,
          "nullable": false,
          "position": 2,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "contact_id",
          "type": "integer",
          "default": null,
          "nullable": true,
          "position": 3,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "company_id",
          "type": "integer",
          "default": null,
          "nullable": false,
          "position": 4,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "received_at",
          "type": "timestamp with time zone",
          "default": "now()",
          "nullable": true,
          "position": 5,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "processed",
          "type": "boolean",
          "default": "true",
          "nullable": true,
          "position": 6,
          "udt_name": "bool",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "workflow_execution_id",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 7,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "received_at_second",
          "type": "bigint",
          "default": null,
          "nullable": true,
          "position": 8,
          "udt_name": "int8",
          "max_length": null,
          "numeric_precision": 64
        }
      ],
      "indexes": [
        {
          "name": "corev4_message_dedup_pkey",
          "is_unique": true,
          "definition": "CREATE UNIQUE INDEX corev4_message_dedup_pkey ON public.corev4_message_dedup USING btree (message_id)",
          "is_primary": true
        },
        {
          "name": "idx_dedup_received",
          "is_unique": false,
          "definition": "CREATE INDEX idx_dedup_received ON public.corev4_message_dedup USING btree (received_at DESC)",
          "is_primary": false
        },
        {
          "name": "idx_dedup_contact",
          "is_unique": false,
          "definition": "CREATE INDEX idx_dedup_contact ON public.corev4_message_dedup USING btree (contact_id, received_at DESC)",
          "is_primary": false
        },
        {
          "name": "idx_dedup_whatsapp_second",
          "is_unique": true,
          "definition": "CREATE UNIQUE INDEX idx_dedup_whatsapp_second ON public.corev4_message_dedup USING btree (whatsapp_id, received_at_second)",
          "is_primary": false
        }
      ],
      "foreign_keys": [],
      "primary_keys": [
        "message_id"
      ],
      "unique_constraints": []
    },
    "corev4_message_media": {
      "columns": [
        {
          "name": "id",
          "type": "integer",
          "default": "nextval('corev4_message_media_id_seq'::regclass)",
          "nullable": false,
          "position": 1,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "message_id",
          "type": "integer",
          "default": null,
          "nullable": true,
          "position": 2,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "storage_provider",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 3,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "storage_path",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 4,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "storage_url",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 5,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "original_url",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 6,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "media_type",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 7,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "mime_type",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 8,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "file_size",
          "type": "integer",
          "default": null,
          "nullable": true,
          "position": 9,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "width",
          "type": "integer",
          "default": null,
          "nullable": true,
          "position": 10,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "height",
          "type": "integer",
          "default": null,
          "nullable": true,
          "position": 11,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "thumbnail_path",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 12,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "embedding",
          "type": "USER-DEFINED",
          "default": null,
          "nullable": true,
          "position": 13,
          "udt_name": "vector",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "ocr_text",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 14,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "transcription",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 15,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "ai_description",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 16,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "ai_tags",
          "type": "ARRAY",
          "default": null,
          "nullable": true,
          "position": 17,
          "udt_name": "_text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "default": null,
          "nullable": true,
          "position": 18,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "company_id",
          "type": "integer",
          "default": null,
          "nullable": false,
          "position": 19,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        }
      ],
      "indexes": [
        {
          "name": "corev4_message_media_pkey",
          "is_unique": true,
          "definition": "CREATE UNIQUE INDEX corev4_message_media_pkey ON public.corev4_message_media USING btree (id)",
          "is_primary": true
        },
        {
          "name": "idx_message_media_company_message",
          "is_unique": false,
          "definition": "CREATE INDEX idx_message_media_company_message ON public.corev4_message_media USING btree (company_id, message_id)",
          "is_primary": false
        }
      ],
      "foreign_keys": [
        {
          "column": "message_id",
          "on_delete": "NO ACTION",
          "on_update": "NO ACTION",
          "constraint_name": "corev4_message_media_message_id_fkey",
          "references_table": "corev4_chat_history",
          "references_column": "id"
        },
        {
          "column": "company_id",
          "on_delete": "NO ACTION",
          "on_update": "NO ACTION",
          "constraint_name": "corev4_message_media_company_id_fkey",
          "references_table": "corev4_companies",
          "references_column": "id"
        }
      ],
      "primary_keys": [
        "id"
      ],
      "unique_constraints": []
    },
    "corev4_contact_extras": {
      "columns": [
        {
          "name": "id",
          "type": "bigint",
          "default": "nextval('corev4_contact_extras_id_seq'::regclass)",
          "nullable": false,
          "position": 1,
          "udt_name": "int8",
          "max_length": null,
          "numeric_precision": 64
        },
        {
          "name": "contact_id",
          "type": "bigint",
          "default": null,
          "nullable": false,
          "position": 2,
          "udt_name": "int8",
          "max_length": null,
          "numeric_precision": 64
        },
        {
          "name": "company_id",
          "type": "integer",
          "default": null,
          "nullable": false,
          "position": 3,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "pipeline_id",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 4,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "crm_id",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 5,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "deals_id",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 6,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "thread_id",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 7,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "stripe_id",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 8,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "audio_response",
          "type": "boolean",
          "default": "false",
          "nullable": true,
          "position": 9,
          "udt_name": "bool",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "text_response",
          "type": "boolean",
          "default": "true",
          "nullable": true,
          "position": 10,
          "udt_name": "bool",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "interactions",
          "type": "integer",
          "default": "0",
          "nullable": true,
          "position": 11,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "last_interaction_at",
          "type": "timestamp with time zone",
          "default": null,
          "nullable": true,
          "position": 12,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "plan_tier",
          "type": "integer",
          "default": null,
          "nullable": true,
          "position": 13,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "evolution_api_contact",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 14,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "default": "now()",
          "nullable": true,
          "position": 15,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "default": "now()",
          "nullable": true,
          "position": 16,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        }
      ],
      "indexes": [
        {
          "name": "corev4_contact_extras_pkey",
          "is_unique": true,
          "definition": "CREATE UNIQUE INDEX corev4_contact_extras_pkey ON public.corev4_contact_extras USING btree (id)",
          "is_primary": true
        },
        {
          "name": "unique_contact_extras",
          "is_unique": true,
          "definition": "CREATE UNIQUE INDEX unique_contact_extras ON public.corev4_contact_extras USING btree (contact_id, company_id)",
          "is_primary": false
        },
        {
          "name": "idx_extras_contact",
          "is_unique": false,
          "definition": "CREATE INDEX idx_extras_contact ON public.corev4_contact_extras USING btree (contact_id)",
          "is_primary": false
        },
        {
          "name": "idx_extras_company",
          "is_unique": false,
          "definition": "CREATE INDEX idx_extras_company ON public.corev4_contact_extras USING btree (company_id)",
          "is_primary": false
        },
        {
          "name": "idx_extras_crm",
          "is_unique": false,
          "definition": "CREATE INDEX idx_extras_crm ON public.corev4_contact_extras USING btree (crm_id) WHERE (crm_id IS NOT NULL)",
          "is_primary": false
        },
        {
          "name": "idx_extras_stripe",
          "is_unique": false,
          "definition": "CREATE INDEX idx_extras_stripe ON public.corev4_contact_extras USING btree (stripe_id) WHERE (stripe_id IS NOT NULL)",
          "is_primary": false
        },
        {
          "name": "idx_extras_last_interaction",
          "is_unique": false,
          "definition": "CREATE INDEX idx_extras_last_interaction ON public.corev4_contact_extras USING btree (last_interaction_at DESC NULLS LAST)",
          "is_primary": false
        }
      ],
      "foreign_keys": [
        {
          "column": "contact_id",
          "on_delete": "CASCADE",
          "on_update": "NO ACTION",
          "constraint_name": "corev4_contact_extras_contact_id_fkey",
          "references_table": "corev4_contacts",
          "references_column": "id"
        }
      ],
      "primary_keys": [
        "id"
      ],
      "unique_constraints": [
        {
          "columns": [
            "contact_id",
            "company_id"
          ],
          "constraint_name": "unique_contact_extras"
        }
      ]
    },
    "corev4_execution_logs": {
      "columns": [
        {
          "name": "id",
          "type": "integer",
          "default": "nextval('corev4_execution_logs_id_seq'::regclass)",
          "nullable": false,
          "position": 1,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "workflow_name",
          "type": "character varying",
          "default": null,
          "nullable": false,
          "position": 2,
          "udt_name": "varchar",
          "max_length": 255,
          "numeric_precision": null
        },
        {
          "name": "execution_id",
          "type": "character varying",
          "default": null,
          "nullable": true,
          "position": 3,
          "udt_name": "varchar",
          "max_length": 255,
          "numeric_precision": null
        },
        {
          "name": "contact_id",
          "type": "integer",
          "default": null,
          "nullable": true,
          "position": 4,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "followup_id",
          "type": "integer",
          "default": null,
          "nullable": true,
          "position": 5,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "action_taken",
          "type": "character varying",
          "default": null,
          "nullable": true,
          "position": 6,
          "udt_name": "varchar",
          "max_length": 100,
          "numeric_precision": null
        },
        {
          "name": "success",
          "type": "boolean",
          "default": "true",
          "nullable": true,
          "position": 7,
          "udt_name": "bool",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "error_message",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 8,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "details",
          "type": "jsonb",
          "default": null,
          "nullable": true,
          "position": 9,
          "udt_name": "jsonb",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "duration_ms",
          "type": "integer",
          "default": null,
          "nullable": true,
          "position": 10,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "default": "now()",
          "nullable": true,
          "position": 11,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        }
      ],
      "indexes": [
        {
          "name": "corev4_execution_logs_pkey",
          "is_unique": true,
          "definition": "CREATE UNIQUE INDEX corev4_execution_logs_pkey ON public.corev4_execution_logs USING btree (id)",
          "is_primary": true
        },
        {
          "name": "idx_execution_logs_workflow",
          "is_unique": false,
          "definition": "CREATE INDEX idx_execution_logs_workflow ON public.corev4_execution_logs USING btree (workflow_name)",
          "is_primary": false
        },
        {
          "name": "idx_execution_logs_contact",
          "is_unique": false,
          "definition": "CREATE INDEX idx_execution_logs_contact ON public.corev4_execution_logs USING btree (contact_id)",
          "is_primary": false
        },
        {
          "name": "idx_execution_logs_followup",
          "is_unique": false,
          "definition": "CREATE INDEX idx_execution_logs_followup ON public.corev4_execution_logs USING btree (followup_id)",
          "is_primary": false
        },
        {
          "name": "idx_execution_logs_success",
          "is_unique": false,
          "definition": "CREATE INDEX idx_execution_logs_success ON public.corev4_execution_logs USING btree (success)",
          "is_primary": false
        },
        {
          "name": "idx_execution_logs_created",
          "is_unique": false,
          "definition": "CREATE INDEX idx_execution_logs_created ON public.corev4_execution_logs USING btree (created_at DESC)",
          "is_primary": false
        }
      ],
      "foreign_keys": [
        {
          "column": "contact_id",
          "on_delete": "SET NULL",
          "on_update": "NO ACTION",
          "constraint_name": "corev4_execution_logs_contact_id_fkey",
          "references_table": "corev4_contacts",
          "references_column": "id"
        }
      ],
      "primary_keys": [
        "id"
      ],
      "unique_constraints": []
    },
    "corev4_followup_steps": {
      "columns": [
        {
          "name": "id",
          "type": "integer",
          "default": "nextval('corev4_followup_steps_id_seq'::regclass)",
          "nullable": false,
          "position": 1,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "config_id",
          "type": "integer",
          "default": null,
          "nullable": false,
          "position": 2,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "step_number",
          "type": "integer",
          "default": null,
          "nullable": false,
          "position": 3,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "wait_hours",
          "type": "integer",
          "default": "0",
          "nullable": false,
          "position": 4,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "wait_minutes",
          "type": "integer",
          "default": "0",
          "nullable": false,
          "position": 5,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "default": "now()",
          "nullable": true,
          "position": 6,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "default": "now()",
          "nullable": true,
          "position": 7,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        }
      ],
      "indexes": [
        {
          "name": "corev4_followup_steps_pkey",
          "is_unique": true,
          "definition": "CREATE UNIQUE INDEX corev4_followup_steps_pkey ON public.corev4_followup_steps USING btree (id)",
          "is_primary": true
        },
        {
          "name": "unique_step_per_config",
          "is_unique": true,
          "definition": "CREATE UNIQUE INDEX unique_step_per_config ON public.corev4_followup_steps USING btree (config_id, step_number)",
          "is_primary": false
        },
        {
          "name": "idx_followup_steps_config",
          "is_unique": false,
          "definition": "CREATE INDEX idx_followup_steps_config ON public.corev4_followup_steps USING btree (config_id)",
          "is_primary": false
        },
        {
          "name": "idx_followup_steps_step",
          "is_unique": false,
          "definition": "CREATE INDEX idx_followup_steps_step ON public.corev4_followup_steps USING btree (step_number)",
          "is_primary": false
        }
      ],
      "foreign_keys": [
        {
          "column": "config_id",
          "on_delete": "CASCADE",
          "on_update": "NO ACTION",
          "constraint_name": "corev4_followup_steps_config_id_fkey",
          "references_table": "corev4_followup_configs",
          "references_column": "id"
        }
      ],
      "primary_keys": [
        "id"
      ],
      "unique_constraints": [
        {
          "columns": [
            "config_id",
            "step_number"
          ],
          "constraint_name": "unique_step_per_config"
        }
      ]
    },
    "corev4_followup_configs": {
      "columns": [
        {
          "name": "id",
          "type": "integer",
          "default": "nextval('corev4_followup_configs_id_seq1'::regclass)",
          "nullable": false,
          "position": 1,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "company_id",
          "type": "integer",
          "default": null,
          "nullable": false,
          "position": 2,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "config_name",
          "type": "character varying",
          "default": null,
          "nullable": false,
          "position": 3,
          "udt_name": "varchar",
          "max_length": 100,
          "numeric_precision": null
        },
        {
          "name": "total_steps",
          "type": "integer",
          "default": "5",
          "nullable": false,
          "position": 4,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "qualification_threshold",
          "type": "integer",
          "default": "60",
          "nullable": true,
          "position": 6,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "disqualification_threshold",
          "type": "integer",
          "default": "15",
          "nullable": true,
          "position": 7,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "max_no_response_days",
          "type": "integer",
          "default": "30",
          "nullable": true,
          "position": 8,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "is_active",
          "type": "boolean",
          "default": "true",
          "nullable": true,
          "position": 15,
          "udt_name": "bool",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "default": "now()",
          "nullable": true,
          "position": 16,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "default": "now()",
          "nullable": true,
          "position": 17,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        }
      ],
      "indexes": [
        {
          "name": "corev4_followup_configs_pkey1",
          "is_unique": true,
          "definition": "CREATE UNIQUE INDEX corev4_followup_configs_pkey1 ON public.corev4_followup_configs USING btree (id)",
          "is_primary": false
        },
        {
          "name": "idx_followup_configs_company",
          "is_unique": false,
          "definition": "CREATE INDEX idx_followup_configs_company ON public.corev4_followup_configs USING btree (company_id)",
          "is_primary": false
        },
        {
          "name": "idx_followup_configs_active",
          "is_unique": false,
          "definition": "CREATE INDEX idx_followup_configs_active ON public.corev4_followup_configs USING btree (is_active) WHERE (is_active = true)",
          "is_primary": false
        },
        {
          "name": "corev4_followup_configs_company_name_key",
          "is_unique": true,
          "definition": "CREATE UNIQUE INDEX corev4_followup_configs_company_name_key ON public.corev4_followup_configs USING btree (company_id, config_name)",
          "is_primary": false
        }
      ],
      "foreign_keys": [
        {
          "column": "company_id",
          "on_delete": "NO ACTION",
          "on_update": "NO ACTION",
          "constraint_name": "corev4_followup_configs_company_id_fkey",
          "references_table": "corev4_companies",
          "references_column": "id"
        }
      ],
      "primary_keys": [
        "id"
      ],
      "unique_constraints": [
        {
          "columns": [
            "company_id",
            "config_name"
          ],
          "constraint_name": "corev4_followup_configs_company_name_key"
        }
      ]
    },
    "corev4_followup_campaigns": {
      "columns": [
        {
          "name": "id",
          "type": "integer",
          "default": "nextval('corev4_followup_campaigns_id_seq1'::regclass)",
          "nullable": false,
          "position": 1,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "contact_id",
          "type": "bigint",
          "default": null,
          "nullable": false,
          "position": 2,
          "udt_name": "int8",
          "max_length": null,
          "numeric_precision": 64
        },
        {
          "name": "company_id",
          "type": "integer",
          "default": null,
          "nullable": false,
          "position": 3,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "config_id",
          "type": "integer",
          "default": null,
          "nullable": false,
          "position": 4,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "status",
          "type": "character varying",
          "default": "'active'::character varying",
          "nullable": true,
          "position": 5,
          "udt_name": "varchar",
          "max_length": 50,
          "numeric_precision": null
        },
        {
          "name": "pause_reason",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 6,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "steps_completed",
          "type": "integer",
          "default": "0",
          "nullable": true,
          "position": 7,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "total_steps",
          "type": "integer",
          "default": null,
          "nullable": false,
          "position": 8,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "last_step_sent_at",
          "type": "timestamp with time zone",
          "default": null,
          "nullable": true,
          "position": 9,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "should_continue",
          "type": "boolean",
          "default": "true",
          "nullable": true,
          "position": 10,
          "udt_name": "bool",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "stopped_reason",
          "type": "character varying",
          "default": null,
          "nullable": true,
          "position": 11,
          "udt_name": "varchar",
          "max_length": 100,
          "numeric_precision": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "default": "now()",
          "nullable": true,
          "position": 12,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "default": "now()",
          "nullable": true,
          "position": 13,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        }
      ],
      "indexes": [
        {
          "name": "corev4_followup_campaigns_pkey1",
          "is_unique": true,
          "definition": "CREATE UNIQUE INDEX corev4_followup_campaigns_pkey1 ON public.corev4_followup_campaigns USING btree (id)",
          "is_primary": false
        },
        {
          "name": "idx_campaigns_contact",
          "is_unique": false,
          "definition": "CREATE INDEX idx_campaigns_contact ON public.corev4_followup_campaigns USING btree (contact_id)",
          "is_primary": false
        },
        {
          "name": "idx_campaigns_company",
          "is_unique": false,
          "definition": "CREATE INDEX idx_campaigns_company ON public.corev4_followup_campaigns USING btree (company_id)",
          "is_primary": false
        },
        {
          "name": "idx_campaigns_config",
          "is_unique": false,
          "definition": "CREATE INDEX idx_campaigns_config ON public.corev4_followup_campaigns USING btree (config_id)",
          "is_primary": false
        },
        {
          "name": "idx_campaigns_status",
          "is_unique": false,
          "definition": "CREATE INDEX idx_campaigns_status ON public.corev4_followup_campaigns USING btree (status)",
          "is_primary": false
        },
        {
          "name": "idx_campaigns_active",
          "is_unique": false,
          "definition": "CREATE INDEX idx_campaigns_active ON public.corev4_followup_campaigns USING btree (should_continue) WHERE (should_continue = true)",
          "is_primary": false
        }
      ],
      "foreign_keys": [
        {
          "column": "config_id",
          "on_delete": "NO ACTION",
          "on_update": "NO ACTION",
          "constraint_name": "corev4_followup_campaigns_config_id_fkey",
          "references_table": "corev4_followup_configs",
          "references_column": "id"
        },
        {
          "column": "company_id",
          "on_delete": "NO ACTION",
          "on_update": "NO ACTION",
          "constraint_name": "corev4_followup_campaigns_company_id_fkey1",
          "references_table": "corev4_companies",
          "references_column": "id"
        },
        {
          "column": "contact_id",
          "on_delete": "NO ACTION",
          "on_update": "NO ACTION",
          "constraint_name": "corev4_followup_campaigns_contact_id_fkey",
          "references_table": "corev4_contacts",
          "references_column": "id"
        }
      ],
      "primary_keys": [
        "id"
      ],
      "unique_constraints": []
    },
    "corev4_followup_sequences": {
      "columns": [
        {
          "name": "id",
          "type": "integer",
          "default": "nextval('corev4_followup_sequences_id_seq'::regclass)",
          "nullable": false,
          "position": 1,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "campaign_id",
          "type": "integer",
          "default": null,
          "nullable": false,
          "position": 2,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "step_number",
          "type": "integer",
          "default": null,
          "nullable": false,
          "position": 3,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "interval_hours",
          "type": "integer",
          "default": null,
          "nullable": false,
          "position": 4,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "message_template",
          "type": "text",
          "default": null,
          "nullable": false,
          "position": 5,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "min_anum_score",
          "type": "integer",
          "default": null,
          "nullable": true,
          "position": 6,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "max_anum_score",
          "type": "integer",
          "default": null,
          "nullable": true,
          "position": 7,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "required_stage",
          "type": "character varying",
          "default": null,
          "nullable": true,
          "position": 8,
          "udt_name": "varchar",
          "max_length": 20,
          "numeric_precision": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "default": "now()",
          "nullable": true,
          "position": 9,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        }
      ],
      "indexes": [
        {
          "name": "corev4_followup_sequences_pkey",
          "is_unique": true,
          "definition": "CREATE UNIQUE INDEX corev4_followup_sequences_pkey ON public.corev4_followup_sequences USING btree (id)",
          "is_primary": true
        },
        {
          "name": "corev4_followup_sequences_campaign_id_step_number_key",
          "is_unique": true,
          "definition": "CREATE UNIQUE INDEX corev4_followup_sequences_campaign_id_step_number_key ON public.corev4_followup_sequences USING btree (campaign_id, step_number)",
          "is_primary": false
        },
        {
          "name": "idx_followup_sequences_campaign",
          "is_unique": false,
          "definition": "CREATE INDEX idx_followup_sequences_campaign ON public.corev4_followup_sequences USING btree (campaign_id)",
          "is_primary": false
        }
      ],
      "foreign_keys": [],
      "primary_keys": [
        "id"
      ],
      "unique_constraints": [
        {
          "columns": [
            "campaign_id",
            "step_number"
          ],
          "constraint_name": "corev4_followup_sequences_campaign_id_step_number_key"
        }
      ]
    },
    "corev4_n8n_chat_histories": {
      "columns": [
        {
          "name": "id",
          "type": "integer",
          "default": "nextval('corev4_n8n_chat_histories_id_seq'::regclass)",
          "nullable": false,
          "position": 1,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "session_id",
          "type": "character varying",
          "default": null,
          "nullable": false,
          "position": 2,
          "udt_name": "varchar",
          "max_length": 255,
          "numeric_precision": null
        },
        {
          "name": "message",
          "type": "jsonb",
          "default": null,
          "nullable": false,
          "position": 3,
          "udt_name": "jsonb",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "contact_id",
          "type": "integer",
          "default": null,
          "nullable": true,
          "position": 4,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        }
      ],
      "indexes": [
        {
          "name": "corev4_n8n_chat_histories_pkey",
          "is_unique": true,
          "definition": "CREATE UNIQUE INDEX corev4_n8n_chat_histories_pkey ON public.corev4_n8n_chat_histories USING btree (id)",
          "is_primary": true
        },
        {
          "name": "idx_n8n_chat_contact",
          "is_unique": false,
          "definition": "CREATE INDEX idx_n8n_chat_contact ON public.corev4_n8n_chat_histories USING btree (contact_id)",
          "is_primary": false
        }
      ],
      "foreign_keys": [
        {
          "column": "contact_id",
          "on_delete": "NO ACTION",
          "on_update": "NO ACTION",
          "constraint_name": "corev4_n8n_chat_histories_contact_id_fkey",
          "references_table": "corev4_contacts",
          "references_column": "id"
        }
      ],
      "primary_keys": [
        "id"
      ],
      "unique_constraints": []
    },
    "corev4_followup_executions": {
      "columns": [
        {
          "name": "id",
          "type": "integer",
          "default": "nextval('corev4_followup_executions_id_seq1'::regclass)",
          "nullable": false,
          "position": 1,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "campaign_id",
          "type": "integer",
          "default": null,
          "nullable": false,
          "position": 2,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "contact_id",
          "type": "bigint",
          "default": null,
          "nullable": false,
          "position": 3,
          "udt_name": "int8",
          "max_length": null,
          "numeric_precision": 64
        },
        {
          "name": "company_id",
          "type": "integer",
          "default": null,
          "nullable": false,
          "position": 4,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "step",
          "type": "integer",
          "default": null,
          "nullable": false,
          "position": 5,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "total_steps",
          "type": "integer",
          "default": null,
          "nullable": false,
          "position": 6,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "scheduled_at",
          "type": "timestamp with time zone",
          "default": null,
          "nullable": false,
          "position": 7,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "executed",
          "type": "boolean",
          "default": "false",
          "nullable": true,
          "position": 8,
          "udt_name": "bool",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "sent_at",
          "type": "timestamp with time zone",
          "default": null,
          "nullable": true,
          "position": 9,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "generated_message",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 10,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "generation_context",
          "type": "jsonb",
          "default": null,
          "nullable": true,
          "position": 11,
          "udt_name": "jsonb",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "should_send",
          "type": "boolean",
          "default": "true",
          "nullable": true,
          "position": 12,
          "udt_name": "bool",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "decision_reason",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 13,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "anum_at_execution",
          "type": "jsonb",
          "default": null,
          "nullable": true,
          "position": 14,
          "udt_name": "jsonb",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "evolution_message_id",
          "type": "character varying",
          "default": null,
          "nullable": true,
          "position": 15,
          "udt_name": "varchar",
          "max_length": 255,
          "numeric_precision": null
        },
        {
          "name": "evolution_api_url",
          "type": "character varying",
          "default": null,
          "nullable": true,
          "position": 16,
          "udt_name": "varchar",
          "max_length": 255,
          "numeric_precision": null
        },
        {
          "name": "evolution_instance",
          "type": "character varying",
          "default": null,
          "nullable": true,
          "position": 17,
          "udt_name": "varchar",
          "max_length": 255,
          "numeric_precision": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "default": "now()",
          "nullable": true,
          "position": 18,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "default": "now()",
          "nullable": true,
          "position": 19,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        }
      ],
      "indexes": [
        {
          "name": "corev4_followup_executions_pkey1",
          "is_unique": true,
          "definition": "CREATE UNIQUE INDEX corev4_followup_executions_pkey1 ON public.corev4_followup_executions USING btree (id)",
          "is_primary": false
        },
        {
          "name": "idx_executions_campaign",
          "is_unique": false,
          "definition": "CREATE INDEX idx_executions_campaign ON public.corev4_followup_executions USING btree (campaign_id)",
          "is_primary": false
        },
        {
          "name": "idx_executions_contact",
          "is_unique": false,
          "definition": "CREATE INDEX idx_executions_contact ON public.corev4_followup_executions USING btree (contact_id)",
          "is_primary": false
        },
        {
          "name": "idx_executions_pending",
          "is_unique": false,
          "definition": "CREATE INDEX idx_executions_pending ON public.corev4_followup_executions USING btree (executed, scheduled_at, should_send) WHERE ((executed = false) AND (should_send = true))",
          "is_primary": false
        },
        {
          "name": "idx_executions_scheduled",
          "is_unique": false,
          "definition": "CREATE INDEX idx_executions_scheduled ON public.corev4_followup_executions USING btree (scheduled_at)",
          "is_primary": false
        }
      ],
      "foreign_keys": [
        {
          "column": "campaign_id",
          "on_delete": "NO ACTION",
          "on_update": "NO ACTION",
          "constraint_name": "corev4_followup_executions_campaign_id_fkey1",
          "references_table": "corev4_followup_campaigns",
          "references_column": "id"
        },
        {
          "column": "contact_id",
          "on_delete": "NO ACTION",
          "on_update": "NO ACTION",
          "constraint_name": "corev4_followup_executions_contact_id_fkey1",
          "references_table": "corev4_contacts",
          "references_column": "id"
        },
        {
          "column": "company_id",
          "on_delete": "NO ACTION",
          "on_update": "NO ACTION",
          "constraint_name": "corev4_followup_executions_company_id_fkey",
          "references_table": "corev4_companies",
          "references_column": "id"
        }
      ],
      "primary_keys": [
        "id"
      ],
      "unique_constraints": []
    },
    "corev4_followup_stage_history": {
      "columns": [
        {
          "name": "id",
          "type": "integer",
          "default": "nextval('corev4_followup_stage_history_id_seq'::regclass)",
          "nullable": false,
          "position": 1,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "company_id",
          "type": "integer",
          "default": null,
          "nullable": true,
          "position": 2,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "contact_id",
          "type": "integer",
          "default": null,
          "nullable": true,
          "position": 3,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "followup_execution_id",
          "type": "integer",
          "default": null,
          "nullable": true,
          "position": 4,
          "udt_name": "int4",
          "max_length": null,
          "numeric_precision": 32
        },
        {
          "name": "old_stage",
          "type": "character varying",
          "default": null,
          "nullable": true,
          "position": 5,
          "udt_name": "varchar",
          "max_length": 20,
          "numeric_precision": null
        },
        {
          "name": "new_stage",
          "type": "character varying",
          "default": null,
          "nullable": true,
          "position": 6,
          "udt_name": "varchar",
          "max_length": 20,
          "numeric_precision": null
        },
        {
          "name": "changed_at",
          "type": "timestamp with time zone",
          "default": "now()",
          "nullable": true,
          "position": 7,
          "udt_name": "timestamptz",
          "max_length": null,
          "numeric_precision": null
        },
        {
          "name": "changed_by",
          "type": "character varying",
          "default": null,
          "nullable": true,
          "position": 8,
          "udt_name": "varchar",
          "max_length": 100,
          "numeric_precision": null
        },
        {
          "name": "notes",
          "type": "text",
          "default": null,
          "nullable": true,
          "position": 9,
          "udt_name": "text",
          "max_length": null,
          "numeric_precision": null
        }
      ],
      "indexes": [
        {
          "name": "corev4_followup_stage_history_pkey",
          "is_unique": true,
          "definition": "CREATE UNIQUE INDEX corev4_followup_stage_history_pkey ON public.corev4_followup_stage_history USING btree (id)",
          "is_primary": true
        },
        {
          "name": "idx_followup_stage_hist_contact",
          "is_unique": false,
          "definition": "CREATE INDEX idx_followup_stage_hist_contact ON public.corev4_followup_stage_history USING btree (contact_id)",
          "is_primary": false
        },
        {
          "name": "idx_followup_stage_hist_exec",
          "is_unique": false,
          "definition": "CREATE INDEX idx_followup_stage_hist_exec ON public.corev4_followup_stage_history USING btree (followup_execution_id)",
          "is_primary": false
        },
        {
          "name": "idx_followup_stage_hist_changed",
          "is_unique": false,
          "definition": "CREATE INDEX idx_followup_stage_hist_changed ON public.corev4_followup_stage_history USING btree (changed_at DESC)",
          "is_primary": false
        }
      ],
      "foreign_keys": [
        {
          "column": "company_id",
          "on_delete": "NO ACTION",
          "on_update": "NO ACTION",
          "constraint_name": "corev4_followup_stage_history_company_id_fkey",
          "references_table": "corev4_companies",
          "references_column": "id"
        },
        {
          "column": "contact_id",
          "on_delete": "CASCADE",
          "on_update": "NO ACTION",
          "constraint_name": "corev4_followup_stage_history_contact_id_fkey",
          "references_table": "corev4_contacts",
          "references_column": "id"
        }
      ],
      "primary_keys": [
        "id"
      ],
      "unique_constraints": []
    }
  },
  "metadata": {
    "schema": "public",
    "extracted_at": "2025-10-26T20:10:59.362536+00:00",
    "total_tables": 18,
    "database_name": "impulso-ia-frank-v4",
    "total_columns": 271,
    "postgresql_version": "PostgreSQL 15.6 on aarch64-unknown-linux-gnu, compiled by gcc (GCC) 13.2.0, 64-bit"
  },
  "analysis_hints": {
    "missing_rls": "Row Level Security not implemented - add RLS policies",
    "indexes_review": "Check if all foreign keys have supporting indexes",
    "session_format": "Current format may expose PII - review session_id implementation",
    "critical_tables": [
      "corev4_contacts",
      "corev4_companies",
      "corev4_lead_state",
      "corev4_followup_campaigns",
      "corev4_chat_history"
    ],
    "multi_tenant_key": "company_id",
    "tenant_isolation": "Check all queries filter by company_id",
    "foreign_key_rules": "Review ON DELETE and ON UPDATE cascades"
  },
  "relationships_graph": {
    "corev4_chats": [
      "corev4_contacts"
    ],
    "corev4_companies": [
      "corev4_followup_configs"
    ],
    "corev4_lead_state": [
      "corev4_companies",
      "corev4_contacts"
    ],
    "corev4_anum_history": [
      "corev4_companies",
      "corev4_contacts"
    ],
    "corev4_message_media": [
      "corev4_chat_history",
      "corev4_companies"
    ],
    "corev4_contact_extras": [
      "corev4_contacts"
    ],
    "corev4_execution_logs": [
      "corev4_contacts"
    ],
    "corev4_followup_steps": [
      "corev4_followup_configs"
    ],
    "corev4_followup_configs": [
      "corev4_companies"
    ],
    "corev4_followup_campaigns": [
      "corev4_companies",
      "corev4_contacts",
      "corev4_followup_configs"
    ],
    "corev4_n8n_chat_histories": [
      "corev4_contacts"
    ],
    "corev4_followup_executions": [
      "corev4_companies",
      "corev4_contacts",
      "corev4_followup_campaigns"
    ],
    "corev4_followup_stage_history": [
      "corev4_companies",
      "corev4_contacts"
    ]
  }
}